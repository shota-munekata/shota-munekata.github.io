<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Urashima Taro Extended Adventure - English Gamebook</title>
    
    <!-- Google AdSense -->
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-XXXXXXXXXXXXXXXXX" 
            crossorigin="anonymous"></script>
    <style>
        body {
            font-family: 'Hiragino Sans', 'ãƒ’ãƒ©ã‚®ãƒè§’ã‚´ã‚·ãƒƒã‚¯', 'Yu Gothic Medium', 'æ¸¸ã‚´ã‚·ãƒƒã‚¯ Medium', YuGothic, 'æ¸¸ã‚´ã‚·ãƒƒã‚¯ä½“', 'Meiryo', Arial, sans-serif;
            max-width: 900px;
            margin: 0 auto;
            padding: 20px;
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            min-height: 100vh;
            position: relative;
        }
        
        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: 
                radial-gradient(circle at 20% 80%, rgba(79, 172, 254, 0.3) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, rgba(255, 255, 255, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, rgba(0, 242, 254, 0.2) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }
        
        .story-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            padding: 40px;
            border-radius: 20px;
            box-shadow: 
                0 8px 32px rgba(0, 0, 0, 0.1),
                0 2px 8px rgba(255, 255, 255, 0.2) inset;
            margin-bottom: 30px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .story-container::before {
            content: '';
            position: absolute;
            top: -2px;
            left: -2px;
            right: -2px;
            bottom: -2px;
            background: linear-gradient(45deg, #4facfe, #00f2fe, #4facfe, #00f2fe, #4facfe);
            border-radius: 22px;
            z-index: -1;
            opacity: 0.1;
        }
        
        .choices {
            margin-top: 20px;
        }
        
        /* Audio controls styling */
        .audio-controls {
            text-align: center;
            margin: 20px 0;
            padding: 15px;
            background-color: rgba(248, 249, 250, 0.8);
            border-radius: 12px;
            border: 1px solid rgba(0, 0, 0, 0.08);
            backdrop-filter: blur(10px);
        }
        
        .audio-btn {
            display: inline-block;
            padding: 10px 20px;
            margin: 0 6px;
            background: linear-gradient(135deg, #17a2b8 0%, #117a8b 100%);
            color: white;
            border: none;
            border-radius: 20px;
            font-size: 13px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 3px 12px rgba(23, 162, 184, 0.3);
            position: relative;
            overflow: hidden;
        }
        
        .audio-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 5px 16px rgba(23, 162, 184, 0.4);
        }
        
        .audio-btn:active {
            transform: translateY(0);
        }
        
        .audio-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.6s;
        }
        
        .audio-btn:hover::before {
            left: 100%;
        }
        
        .choice-container {
            display: flex;
            align-items: center;
            margin: 8px 0;
            gap: 8px;
        }
        
        .choice-button-main {
            flex: 1;
            padding: 12px 16px;
            background: linear-gradient(135deg, #28a745 0%, #20c997 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 0.95em;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 3px 12px rgba(40, 167, 69, 0.3);
            text-align: left;
            border: 1px solid rgba(255, 255, 255, 0.2);
        }
        
        .choice-button-main:hover {
            transform: translateY(-1px);
            box-shadow: 0 4px 16px rgba(40, 167, 69, 0.4);
        }
        
        .choice-audio-btn {
            padding: 8px 12px;
            background: linear-gradient(135deg, #6f42c1 0%, #5a32a3 100%);
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 2px 8px rgba(111, 66, 193, 0.3);
            min-width: 40px;
        }
        
        .choice-audio-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 3px 12px rgba(111, 66, 193, 0.4);
        }
        
        h1 {
            color: #2c3e50;
            text-align: center;
            font-size: 2.4em;
            margin-bottom: 15px;
            font-weight: 700;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.1);
            background: linear-gradient(135deg, #2c3e50 0%, #4facfe 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .subtitle {
            text-align: center;
            color: #34495e;
            font-size: 1.2em;
            margin-bottom: 30px;
            font-style: italic;
            font-weight: 300;
        }
        
        .story-text {
            font-size: 1.1em;
            line-height: 1.8;
            color: #2c3e50;
            margin-bottom: 25px;
            text-align: justify;
        }
        
        .story-text p {
            margin-bottom: 15px;
        }
        
        .scene {
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.5s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        .scene:not(.hidden) {
            opacity: 1;
            transform: translateY(0);
        }
        
        .fade-in {
            animation: fadeIn 0.8s ease-out;
        }
        
        @keyframes fadeIn {
            from { 
                opacity: 0; 
                transform: translateY(30px) scale(0.95);
            }
            to { 
                opacity: 1; 
                transform: translateY(0) scale(1);
            }
        }
        
        .hidden {
            display: none !important;
        }
        
        .choice-explanation {
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            border: 2px solid #ffd93d;
            padding: 20px;
            border-radius: 15px;
            margin: 20px 0;
            position: relative;
            box-shadow: 0 4px 15px rgba(255, 217, 61, 0.3);
        }
        
        .choice-explanation::before {
            content: "ğŸ’¡";
            position: absolute;
            top: -12px;
            left: 20px;
            background: linear-gradient(135deg, #fff3cd 0%, #ffeaa7 100%);
            padding: 0 12px;
            font-size: 1.3em;
            border-radius: 50%;
        }
        
        .choice-explanation h4 {
            color: #856404;
            margin-bottom: 12px;
            font-size: 1.1em;
            font-weight: 600;
        }
        
        .choice-explanation p {
            color: #856404;
            line-height: 1.6;
            margin-bottom: 8px;
        }
        
        .restart-btn {
            background: linear-gradient(135deg, #fd79a8 0%, #e84393 100%) !important;
            box-shadow: 0 4px 15px rgba(253, 121, 168, 0.3) !important;
        }
        
        .restart-btn:hover {
            box-shadow: 0 6px 20px rgba(253, 121, 168, 0.4) !important;
        }
        
        .home-btn {
            background: linear-gradient(135deg, #6c5ce7 0%, #5f27cd 100%) !important;
            box-shadow: 0 4px 15px rgba(108, 92, 231, 0.3) !important;
        }
        
        .home-btn:hover {
            box-shadow: 0 6px 20px rgba(108, 92, 231, 0.4) !important;
        }
        
        .nav-link {
            display: inline-block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #74b9ff 0%, #0984e3 100%);
            color: white;
            text-decoration: none;
            border-radius: 25px;
            font-weight: 500;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: 0 4px 15px rgba(116, 185, 255, 0.3);
        }
        
        .nav-link:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(116, 185, 255, 0.4);
            color: white;
            text-decoration: none;
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background-color: rgba(255, 255, 255, 0.3);
            border-radius: 4px;
            overflow: hidden;
            margin: 10px 0;
            box-shadow: inset 0 2px 4px rgba(0, 0, 0, 0.1);
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #4facfe 0%, #00f2fe 100%);
            border-radius: 4px;
            transition: width 0.5s ease;
            position: relative;
        }
        
        .progress-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.3), transparent);
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }
        
        .scene-counter {
            text-align: center;
            font-weight: 600;
            color: #2c3e50;
            font-size: 0.95em;
            margin-bottom: 5px;
        }
        
        /* Choice explanation styling from momotaro */
        .choice-explanation {
            background: linear-gradient(135deg, #e8f5e8 0%, #f0f8ff 100%);
            border: 2px solid #4CAF50;
            border-radius: 15px;
            padding: 20px;
            margin: 20px 0;
            box-shadow: 0 4px 15px rgba(76, 175, 80, 0.2);
            position: relative;
            overflow: hidden;
        }
        
        .choice-explanation::before {
            content: '';
            position: absolute;
            top: -5px;
            left: 15px;
            background: white;
            padding: 5px 10px;
            border-radius: 15px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            font-size: 18px;
            display: none;
        }
        
        .choice-explanation h3 {
            color: #2e7d32;
            margin: 0 0 20px 0;
            font-size: 18px;
            font-weight: 600;
            line-height: 1.6;
            padding-top: 5px;
        }
        
        .choice-explanation h3::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            font-size: 20px;
            display: none;
        }
        
        .choice-display {
            background: rgba(255, 255, 255, 0.8);
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 15px;
            border-left: 4px solid #4CAF50;
        }
        
        .choice-display .english-text {
            font-size: 16px;
            font-weight: 600;
            color: #1565c0;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .choice-display .japanese-text {
            font-size: 15px;
            color: #2e7d32;
            font-weight: 500;
        }
        
        .explanation-text {
            font-size: 14px;
            color: #424242;
            line-height: 1.6;
            background: rgba(255, 255, 255, 0.6);
            padding: 12px;
            border-radius: 8px;
            border-left: 3px solid #81c784;
        }
        
        .choice-explanation.wrong {
            background: linear-gradient(135deg, #fde8e8 0%, #ffebee 100%);
            border: 2px solid #dc3545;
        }
        
        .choice-explanation.wrong::before {
            content: '';
            display: none;
        }
        
        .choice-explanation.wrong h3 {
            color: #c62828;
        }
        
        .choice-explanation.wrong h3::before {
            content: '';
            display: none;
        }
        
        .choice-explanation.wrong .choice-display {
            border-left: 4px solid #dc3545;
        }
        
        .choice-explanation.wrong .choice-display .japanese-text {
            color: #c62828;
        }
        
        .choice-explanation.wrong .explanation-text {
            border-left: 3px solid #ef5350;
        }
        
        .negative-feedback {
            color: #d32f2f !important;
            font-weight: 600;
        }
        
        .previous-question {
            background: rgba(255, 255, 255, 0.05);
            padding: 15px;
            border-radius: 10px;
            border-left: 4px solid #4CAF50;
            margin-bottom: 20px;
        }
        
        .previous-question .english-text {
            font-size: 16px;
            color: #2e7d32;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .previous-question .japanese-text {
            font-size: 14px;
            color: #666;
            font-style: italic;
        }
        
        .section-divider {
            height: 20px;
            border-bottom: 1px solid rgba(79, 172, 254, 0.2);
            margin: 20px 0;
        }
        
        /* AdSense styling */
        .adsense-container {
            text-align: center;
            margin: 30px 0;
            padding: 20px;
            background-color: rgba(255, 255, 255, 0.1);
            border-radius: 15px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            backdrop-filter: blur(10px);
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }
        
        .adsense-label {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 10px;
        }
        
        /* Responsive design */
        @media (max-width: 768px) {
            body {
                padding: 15px;
            }
            
            .story-container {
                padding: 25px;
            }
            
            h1 {
                font-size: 2em;
            }
            
            .story-text {
                font-size: 1em;
            }
            
            .choice-button-main {
                padding: 10px 14px;
                font-size: 0.9em;
            }
        }
        
        @media (max-width: 480px) {
            .story-container {
                padding: 20px;
            }
            
            h1 {
                font-size: 1.8em;
            }
            
            .choice-container {
                flex-direction: column;
                gap: 4px;
            }
            
            .choice-audio-btn {
                align-self: flex-end;
                margin-top: -4px;
            }
        }
    </style>
</head>
<body>
    
    <!-- Navigation -->
    <div style="text-align: left; margin-bottom: 20px;">
        <a href="index.html" class="nav-link">â† ãƒ«ãƒ¼ãƒ«èª¬æ˜ã«æˆ»ã‚‹</a>
    </div>
    
    <!-- AdSense åºƒå‘Š (ãƒ˜ãƒƒãƒ€ãƒ¼ä¸‹) -->
    <div class="adsense-container">
        <div class="adsense-label">åºƒå‘Š</div>
        <ins class="adsbygoogle"
             style="display:block"
             data-ad-client="ca-pub-XXXXXXXXXXXXXXXXX"
             data-ad-slot="XXXXXXXXXX"
             data-ad-format="auto"
             data-full-width-responsive="true"></ins>
        <script>
             (adsbygoogle = window.adsbygoogle || []).push({});
        </script>
    </div>
    
    <!-- Progress Bar -->
    <div style="text-align: center; margin: 20px 0;">
        <div class="scene-counter" id="scene-progress" style="margin-bottom: 8px;">Scene 1 of 22</div>
        <div class="progress-bar">
            <div class="progress-fill" id="progress-fill" style="width: 4.55%;"></div>
        </div>
    </div>
    
    <div class="story-container">
        <h1>æµ¦å³¶å¤ªéƒã®å†’é™º</h1>
        <p class="subtitle">ï½è©³ç´°ç‰ˆï¼šæµ·ã®ä¸­ã®ä¸æ€è­°ãªä¸–ç•Œï½</p>
        
        <!-- Scene 1: Taro's Daily Life -->
        <div id="scene1" class="scene">
            <div class="story-text" data-scene="scene1">
                <p>Long, long ago, in a small fishing village by the sea, there lived a young man named Urashima Taro.</p>
                <p>Taro was known throughout the village for his kindness and gentle heart.</p>
                <p>Every morning, he would wake up early and prepare his fishing boat and nets.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene1')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene2', 'Go fishing to help feed the village')">Go fishing to help feed the village</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Go fishing to help feed the village')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene1', 'Stay home and rest')">Stay home and rest</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Stay home and rest')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene1', 'Go to the market instead')">Go to the market instead</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Go to the market instead')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 2: At the Beach -->
        <div id="scene2" class="scene hidden">
            <div class="story-text" data-scene="scene2">
                <p>Taro walked to the beautiful sandy beach where his boat was waiting.</p>
                <p>The morning sun sparkled on the calm blue water. Seabirds flew overhead, calling to each other.</p>
                <p>As he prepared his fishing nets, he heard some noise coming from the rocks near the shore.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene2')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene3', 'Investigate the noise')">Investigate the noise</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Investigate the noise')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene2', 'Ignore it and go fishing')">Ignore it and go fishing</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ignore it and go fishing')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene2', 'Call for help immediately')">Call for help immediately</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Call for help immediately')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 3: Discovery of the Turtle -->
        <div id="scene3" class="scene hidden">
            <div class="story-text" data-scene="scene3">
                <p>Taro walked toward the rocks and discovered a group of children.</p>
                <p>They had found a large sea turtle and were poking it with sticks, laughing loudly.</p>
                <p>The poor turtle was trying to return to the water, but the children kept blocking its path.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene3')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene4', 'Gently ask the children to stop')">Gently ask the children to stop</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Gently ask the children to stop')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene3', 'Shout angrily at the children')">Shout angrily at the children</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Shout angrily at the children')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene3', 'Join the children')">Join the children</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Join the children')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 4: Talking to the Children -->
        <div id="scene4" class="scene hidden">
            <div class="story-text" data-scene="scene4">
                <p>"Children, please don't hurt this turtle," Taro said kindly. "It's a living creature, just like us."</p>
                <p>The children looked up at Taro. He knelt down to their level and spoke gently.</p>
                <p>"How would you feel if someone much bigger than you treated you this way?"</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene4')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene5', 'Wait patiently for their response')">Wait patiently for their response</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Wait patiently for their response')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene4', 'Take the turtle away immediately')">Take the turtle away immediately</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Take the turtle away immediately')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene4', 'Threaten to tell their parents')">Threaten to tell their parents</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Threaten to tell their parents')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 5: Children's Understanding -->
        <div id="scene5" class="scene hidden">
            <div class="story-text" data-scene="scene5">
                <p>The children looked at each other, then at the turtle. They began to understand.</p>
                <p>"We're sorry, Mr. Taro," said the youngest child. "We didn't mean to hurt it."</p>
                <p>The children stepped back and watched as the turtle slowly moved toward the water.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene5')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene6', 'Help the turtle reach the water safely')">Help the turtle reach the water safely</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Help the turtle reach the water safely')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene5', 'Leave immediately')">Leave immediately</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Leave immediately')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene5', 'Lecture the children more')">Lecture the children more</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Lecture the children more')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 6: Saving the Turtle -->
        <div id="scene6" class="scene hidden">
            <div class="story-text" data-scene="scene6">
                <p>Taro gently picked up the large turtle. It was heavier than he expected.</p>
                <p>He carried it carefully to the water's edge and placed it gently in the shallow waves.</p>
                <p>The turtle looked up at Taro with its wise, old eyes before swimming away.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene6')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene7', 'Watch the turtle swim away peacefully')">Watch the turtle swim away peacefully</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Watch the turtle swim away peacefully')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene6', 'Go fishing immediately')">Go fishing immediately</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Go fishing immediately')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene6', 'Ask for a reward')">Ask for a reward</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask for a reward')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 7: The Turtle's Return -->
        <div id="scene7" class="scene hidden">
            <div class="story-text" data-scene="scene7">
                <p>As Taro watched, something amazing happened. The turtle turned around and swam back to him.</p>
                <p>It lifted its head above the water and, to Taro's amazement, began to speak!</p>
                <p>"Thank you, kind young man, for saving my life," said the turtle in a gentle voice.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene7')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene8', 'Listen politely to what the turtle has to say')">Listen politely to what the turtle has to say</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Listen politely to what the turtle has to say')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene7', 'Run away in fear')">Run away in fear</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Run away in fear')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene7', 'Think it is a dream and ignore it')">Think it is a dream and ignore it</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Think it is a dream and ignore it')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 8: The Invitation -->
        <div id="scene8" class="scene hidden">
            <div class="story-text" data-scene="scene8">
                <p>"I am actually a servant of the Dragon King who rules the sea," explained the turtle.</p>
                <p>"My master would like to meet you and thank you personally for your kindness."</p>
                <p>"Would you come with me to the Dragon Palace under the sea?"</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene8')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene9', 'Accept the invitation with gratitude')">Accept the invitation with gratitude</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Accept the invitation with gratitude')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene8', 'Politely decline')">Politely decline</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Politely decline')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene8', 'Ask what is in it for him')">Ask what is in it for him</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask what is in it for him')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 9: The Journey Begins -->
        <div id="scene9" class="scene hidden">
            <div class="story-text" data-scene="scene9">
                <p>"I would be honored to meet the Dragon King," Taro replied with a bow.</p>
                <p>The turtle swam closer to the shore. "Please climb on my back," it said.</p>
                <p>Taro carefully stepped onto the turtle's large, strong shell.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene9')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene10', 'Hold on carefully and trust the turtle')">Hold on carefully and trust the turtle</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Hold on carefully and trust the turtle')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene9', 'Jump off immediately')">Jump off immediately</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Jump off immediately')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene9', 'Ask to go back')">Ask to go back</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask to go back')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 10: Under the Sea -->
        <div id="scene10" class="scene hidden">
            <div class="story-text" data-scene="scene10">
                <p>The turtle began to dive deeper and deeper into the blue ocean.</p>
                <p>To Taro's amazement, he found he could breathe perfectly underwater!</p>
                <p>Beautiful fish of every color swam around them, and coral gardens sparkled in the deep.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene10')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene11', 'Marvel at the underwater beauty')">Marvel at the underwater beauty</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Marvel at the underwater beauty')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene10', 'Panic about breathing underwater')">Panic about breathing underwater</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Panic about breathing underwater')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene10', 'Try to swim away')">Try to swim away</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Try to swim away')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 11: The Dragon Palace -->
        <div id="scene11" class="scene hidden">
            <div class="story-text" data-scene="scene11">
                <p>Soon they arrived at the most magnificent palace Taro had ever imagined.</p>
                <p>It was made of coral and pearls, with towers that spiraled toward the surface.</p>
                <p>Fish of gold and silver swam in and out of the palace windows like living decorations.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene11')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene12', 'Express wonder and gratitude')">Express wonder and gratitude</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Express wonder and gratitude')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene11', 'Ask about the value of the palace')">Ask about the value of the palace</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask about the value of the palace')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene11', 'Remain silent and unimpressed')">Remain silent and unimpressed</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Remain silent and unimpressed')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 12: Meeting the Dragon King -->
        <div id="scene12" class="scene hidden">
            <div class="story-text" data-scene="scene12">
                <p>Inside the palace, Taro met the Dragon King and his beautiful daughter, Princess Otohime.</p>
                <p>"Welcome, kind Urashima Taro," said the Dragon King. "You have shown great compassion today."</p>
                <p>"Please, stay with us and enjoy the wonders of our undersea kingdom."</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene12')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene13', 'Bow respectfully and thank them')">Bow respectfully and thank them</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Bow respectfully and thank them')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene12', 'Immediately ask for treasures')">Immediately ask for treasures</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Immediately ask for treasures')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene12', 'Say you want to go home right away')">Say you want to go home right away</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Say you want to go home right away')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 13-19: Life in the Palace (continuing...) -->
        <!-- Scene 13: First Day in Paradise -->
        <div id="scene13" class="scene hidden">
            <div class="story-text" data-scene="scene13">
                <p>Taro spent his first day in the Dragon Palace amazed by its wonders.</p>
                <p>Princess Otohime showed him gardens of sea anemones and singing whales.</p>
                <p>The food was more delicious than anything he had ever tasted.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene13')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene14', 'Enjoy the experience with gratitude')">Enjoy the experience with gratitude</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Enjoy the experience with gratitude')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene13', 'Complain that it is different from home')">Complain that it is different from home</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Complain that it is different from home')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene13', 'Ask when you can leave')">Ask when you can leave</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask when you can leave')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 14: Growing Friendship -->
        <div id="scene14" class="scene hidden">
            <div class="story-text" data-scene="scene14">
                <p>As days passed, Taro and Princess Otohime became close friends.</p>
                <p>She taught him about the sea creatures and the mysteries of the ocean.</p>
                <p>Taro shared stories of his village and the life of fishermen.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene14')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene15', 'Share stories and learn about each others worlds')">Share stories and learn about each other's worlds</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Share stories and learn about each others worlds')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene14', 'Only talk about yourself')">Only talk about yourself</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Only talk about yourself')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene14', 'Remain distant and formal')">Remain distant and formal</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Remain distant and formal')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 15: The Realization -->
        <div id="scene15" class="scene hidden">
            <div class="story-text" data-scene="scene15">
                <p>One day, as Taro watched the sunset through the water, he felt a pang in his heart.</p>
                <p>He realized he missed his village, his family, and his simple fishing boat.</p>
                <p>Though the palace was beautiful, he longed for his home.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene15')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene16', 'Honestly share your feelings with the Princess')">Honestly share your feelings with the Princess</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Honestly share your feelings with the Princess')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene15', 'Hide your feelings and pretend to be happy')">Hide your feelings and pretend to be happy</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Hide your feelings and pretend to be happy')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene15', 'Demand to leave immediately')">Demand to leave immediately</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Demand to leave immediately')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 16: The Princess's Understanding -->
        <div id="scene16" class="scene hidden">
            <div class="story-text" data-scene="scene16">
                <p>"I understand, dear Taro," said Princess Otohime sadly but kindly.</p>
                <p>"Home is always in one's heart. Though I will miss you, you must follow your heart."</p>
                <p>"I have a gift for you before you leave," she said, producing a beautiful lacquered box.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene16')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene17', 'Accept the gift with gratitude')">Accept the gift with gratitude</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Accept the gift with gratitude')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene16', 'Refuse the gift')">Refuse the gift</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Refuse the gift')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene16', 'Ask what is inside')">Ask what is inside</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask what is inside')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 17: The Tamatebako -->
        <div id="scene17" class="scene hidden">
            <div class="story-text" data-scene="scene17">
                <p>"This is called Tamatebako," the Princess explained.</p>
                <p>"But you must promise me one thing - never, ever open this box."</p>
                <p>"If you open it, something terrible will happen, and you can never return here."</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene17')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene18', 'Promise solemnly never to open it')">Promise solemnly never to open it</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Promise solemnly never to open it')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene17', 'Ask why you cannot open it')">Ask why you cannot open it</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask why you cannot open it')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene17', 'Say you cannot make such a promise')">Say you cannot make such a promise</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Say you cannot make such a promise')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 18: The Journey Home -->
        <div id="scene18" class="scene hidden">
            <div class="story-text" data-scene="scene18">
                <p>The same kind turtle carried Taro back to the surface.</p>
                <p>As they rose through the blue water, Taro clutched the mysterious box carefully.</p>
                <p>Soon, he could see the sunlight sparkling on the waves above.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene18')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene19', 'Thank the turtle for everything')">Thank the turtle for everything</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Thank the turtle for everything')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene18', 'Ask to go back to the palace')">Ask to go back to the palace</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask to go back to the palace')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene18', 'Look inside the box')">Look inside the box</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Look inside the box')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 19: The Shocking Discovery -->
        <div id="scene19" class="scene hidden">
            <div class="story-text" data-scene="scene19">
                <p>Taro stepped onto the familiar beach, but something was wrong.</p>
                <p>The village looked completely different! The houses were different, the people were strangers.</p>
                <p>An old man approached him. "Young man, this village hasn't had anyone named Urashima Taro for over 300 years!"</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene19')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene20', 'Ask more questions about what happened')">Ask more questions about what happened</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Ask more questions about what happened')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene19', 'Refuse to believe it')">Refuse to believe it</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Refuse to believe it')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene19', 'Run away in panic')">Run away in panic</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Run away in panic')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 20: Understanding the Truth -->
        <div id="scene20" class="scene hidden">
            <div class="story-text" data-scene="scene20">
                <p>The old man explained, "Urashima Taro was a legend from long ago. They say he saved a turtle and disappeared into the sea."</p>
                <p>Taro realized that time moved differently in the Dragon Palace.</p>
                <p>What felt like days underwater had been centuries on land!</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene20')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('scene21', 'Accept this sad reality')">Accept this sad reality</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Accept this sad reality')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene20', 'Deny everything')">Deny everything</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Deny everything')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene20', 'Blame the turtle')">Blame the turtle</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Blame the turtle')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 21: The Final Choice -->
        <div id="scene21" class="scene hidden">
            <div class="story-text" data-scene="scene21">
                <p>Taro sat alone on the beach, feeling lost and lonely.</p>
                <p>Everyone he had ever known was gone. His old life had disappeared.</p>
                <p>In his hands, he still held the mysterious Tamatebako box from Princess Otohime.</p>
            </div>
            <div class="audio-controls">
                <button class="audio-btn" onclick="playSceneAudio('scene21')">ğŸ”Š è‹±èªéŸ³å£°ã‚’å†ç”Ÿ</button>
                <button class="audio-btn" onclick="stopAudio()">â¹ï¸ åœæ­¢</button>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('ending-good', 'Keep your promise and never open the box')">Keep your promise and never open the box</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Keep your promise and never open the box')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="selectChoiceAndGoToScene('ending-sad', 'Open the box in desperation')">Open the box in desperation</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Open the box in desperation')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main" onclick="showWrongChoice('scene21', 'Throw the box into the sea')">Throw the box into the sea</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Throw the box into the sea')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Scene 22: Good Ending -->
        <div id="ending-good" class="scene hidden">
            <div class="story-text">
                <h2 style="color: #28a745; text-align: center;">ğŸ‰ æœ€é«˜ã®ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°ï¼</h2>
                <p>Even in his loneliness and confusion, Taro kept his promise to Princess Otohime.</p>
                <p>He never opened the Tamatebako box, proving his honor and trustworthiness.</p>
                <p>Because of his faithfulness, Princess Otohime appeared on the beach before him.</p>
                <p>"You are truly a man of your word," she said with tears of joy. "Come back to the Dragon Palace with me, and live there forever as my husband."</p>
                <p><strong>Congratulations! You completed Urashima Taro's extended adventure with the perfect ending!</strong></p>
            </div>
            <div style="padding: 20px 0;">
                
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main restart-btn" onclick="restartGame()">Play Again</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Play Again')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main home-btn" onclick="location.href='index.html'">â† ãƒ«ãƒ¼ãƒ«èª¬æ˜ã«æˆ»ã‚‹</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Return to rules explanation')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <!-- Sad Ending -->
        <div id="ending-sad" class="scene hidden">
            <div class="story-text">
                <h2 style="color: #dc3545; text-align: center;">ğŸ˜¢ æ‚²ã—ã„ã‚¨ãƒ³ãƒ‡ã‚£ãƒ³ã‚°</h2>
                <p>Overcome by loneliness and desperation, Taro broke his promise and opened the Tamatebako.</p>
                <p>White smoke poured out of the box, and suddenly Taro aged 300 years in an instant!</p>
                <p>He became an ancient old man, his hair white as snow, his back bent with age.</p>
                <p>The box had contained all the years he should have lived while in the Dragon Palace.</p>
                <p>He realized too late that keeping promises is more important than temporary relief from sadness.</p>
                <p><strong>Remember: Always keep your promises, even when it's difficult!</strong></p>
            </div>
            <div style="padding: 20px 0;">
                
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main restart-btn" onclick="restartGame()">Play Again</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Play Again')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main home-btn" onclick="location.href='index.html'">â† ãƒ«ãƒ¼ãƒ«èª¬æ˜ã«æˆ»ã‚‹</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Return to rules explanation')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>

        <div id="wrong-message" class="scene hidden">
            <!-- Choice explanation area for wrong choices -->
            <div id="wrong-message-explanation" class="choice-explanation wrong hidden">
                <h3>ã‚ãªãŸãŒé¸ã‚“ã é¸æŠè‚¢</h3>
                <div class="choice-display">
                    <div class="english-text">
                        <span id="wrong-message-choice-text"></span>
                    </div>
                    <div class="japanese-text" id="wrong-message-choice-translation"></div>
                </div>
                <div class="explanation-text" id="wrong-message-choice-explanation"></div>
            </div>
            <div class="section-divider hidden" id="wrong-message-divider" style="height: 20px; border-bottom: 1px solid rgba(220, 53, 69, 0.2); margin: 20px 0;"></div>
            
            <div class="story-text" data-scene="wrong-message">
                <p>ğŸš« <span class="negative-feedback">Oops!</span> That choice doesn't match the real Urashima Taro story.</p>
                <p>In the traditional story, Urashima Taro is kind, honest, and keeps his promises.</p>
                <p>Try again and choose the answer that shows kindness and honesty!</p>
            </div>
            <div class="choices">
                <div class="choice-container">
                    <button class="choice-button-main" onclick="goBack()">Try Again</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Try Again')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main restart-btn" onclick="restartGame()">Start Over</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Start Over')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
                <div class="choice-container">
                    <button class="choice-button-main home-btn" onclick="location.href='index.html'">â† ãƒ«ãƒ¼ãƒ«èª¬æ˜ã«æˆ»ã‚‹</button>
                    <button class="choice-audio-btn" onclick="playChoiceAudio('Return to rules explanation')" title="ã“ã®é¸æŠè‚¢ã®éŸ³å£°ã‚’å†ç”Ÿ">ğŸ”Š</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Game state variables
        let currentScene = 'scene1';
        let previousScene = 'scene1';
        let currentSceneNumber = 1;
        const totalScenes = 22;
        
        // Audio variables
        let currentSpeech = null;
        
        // Store selected choice information
        let selectedChoiceInfo = {
            text: '',
            translation: '',
            explanation: ''
        };
        
        // Store previous question information
        let previousQuestionInfo = {
            text: '',
            translation: ''
        };
        
        // Question translations for Extended Urashima Taro
        const questionTranslations = {
            "Every morning, he would wake up early and prepare his fishing boat and nets.": "æ¯æœæ—©ãèµ·ãã¦ã€é‡£ã‚Šèˆ¹ã¨ç¶²ã®æº–å‚™ã‚’ã—ã¾ã—ãŸã€‚",
            "As he prepared his fishing nets, he heard some noise coming from the rocks near the shore.": "é‡£ã‚Šç¶²ã®æº–å‚™ã‚’ã—ã¦ã„ã‚‹ã¨ã€å²¸ã®å²©ã‹ã‚‰éŸ³ãŒèã“ãˆã¦ãã¾ã—ãŸã€‚",
            "The poor turtle was trying to return to the water, but the children kept blocking its path.": "ã‹ã‚ã„ãã†ãªã‚«ãƒ¡ã¯æ°´ã«æˆ»ã‚ã†ã¨ã—ã¦ã„ã¾ã—ãŸãŒã€å­ä¾›ãŸã¡ãŒé“ã‚’å¡ã„ã§ã„ã¾ã—ãŸã€‚",
            "How would you feel if someone much bigger than you treated you this way?": "ã‚ãªãŸã‚ˆã‚Šã‚‚ãšã£ã¨å¤§ããªäººãŒã‚ãªãŸã‚’ã“ã‚“ãªé¢¨ã«æ‰±ã£ãŸã‚‰ã©ã†æ„Ÿã˜ã‚‹ï¼Ÿ",
            "What should Taro do next?": "å¤ªéƒã¯æ¬¡ã«ä½•ã‚’ã™ã¹ãã§ã—ã‚‡ã†ã‹ï¼Ÿ",
            "What should Taro do?": "å¤ªéƒã¯ã©ã†ã™ã¹ãã§ã—ã‚‡ã†ã‹ï¼Ÿ",
            "But Taro started to feel homesick. What should he do?": "ã§ã‚‚ã€å¤ªéƒã¯ãƒ›ãƒ¼ãƒ ã‚·ãƒƒã‚¯ã«ãªã‚Šã¾ã—ãŸã€‚ã©ã†ã™ã¹ãã§ã—ã‚‡ã†ã‹ï¼Ÿ"
        };
        
        // Comprehensive translation dictionary for Extended Urashima Taro choices
        const choiceTranslations = {
            // Scene 1 choices
            "Go fishing to help feed the village": {
                translation: "æ‘ã‚’é£Ÿã¹ã•ã›ã‚‹ãŸã‚ã«é‡£ã‚Šã«è¡Œã",
                explanation: "æ­£è§£ï¼å¤ªéƒã¯å‹¤å‹‰ã§æ‘ã®ãŸã‚ã«åƒãå„ªã—ã„æ¼å¸«ã§ã™ã€‚"
            },
            "Stay home and rest": {
                translation: "å®¶ã«ã„ã¦ä¼‘ã‚€",
                explanation: "å‹¤å‹‰ãªå¤ªéƒã¯æ¯æ—¥ä¸€ç”Ÿæ‡¸å‘½åƒãã¾ã™ã€‚ä¼‘ã‚“ã§ã„ã‚‹æš‡ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚"
            },
            "Go to the market instead": {
                translation: "ä»£ã‚ã‚Šã«å¸‚å ´ã«è¡Œã",
                explanation: "å¤ªéƒã¯æ¼å¸«ã§ã™ã€‚ã¾ãšã¯è‡ªåˆ†ã®ä»•äº‹ã‚’ã—ã£ã‹ã‚Šã¨ã‚„ã‚Šã¾ã—ã‚‡ã†ã€‚"
            },
            
            // Scene 2 choices
            "Investigate the noise": {
                translation: "éŸ³ã‚’èª¿ã¹ã‚‹",
                explanation: "æ­£è§£ï¼å›°ã£ã¦ã„ã‚‹ç”Ÿãç‰©ãŒã„ã‚‹ã‹ã‚‚ã—ã‚Œã¾ã›ã‚“ã€‚ç¢ºèªã—ã¾ã—ã‚‡ã†ã€‚"
            },
            "Ignore it and start fishing": {
                translation: "ç„¡è¦–ã—ã¦é‡£ã‚Šã‚’å§‹ã‚ã‚‹",
                explanation: "å¤ªéƒã¯å¿ƒå„ªã—ã„äººã§ã™ã€‚æ°—ã«ãªã‚‹éŸ³ãŒã‚ã‚Œã°ç¢ºèªã—ã¾ã™ã€‚"
            },
            "Go back home": {
                translation: "å®¶ã«å¸°ã‚‹",
                explanation: "ã›ã£ã‹ãæµ·ã«æ¥ãŸã®ã§ã™ã‹ã‚‰ã€ä½•ã‹ç›®çš„ã‚’æœãŸã—ã¾ã—ã‚‡ã†ã€‚"
            },
            
            // Scene 3 choices
            "Help the turtle immediately": {
                translation: "ã™ãã«ã‚«ãƒ¡ã‚’åŠ©ã‘ã‚‹",
                explanation: "æ­£è§£ï¼å›°ã£ã¦ã„ã‚‹ç”Ÿãç‰©ã‚’ã™ãã«åŠ©ã‘ã‚‹ã®ãŒå¤ªéƒã‚‰ã—ã„è¡Œå‹•ã§ã™ã€‚"
            },
            "Watch and wait": {
                translation: "æ§˜å­ã‚’è¦‹ã¦å¾…ã¤",
                explanation: "æ‚ªåŒ–ã™ã‚‹å‰ã«ã™ãã«è¡Œå‹•ã™ã‚‹ã¹ãã§ã™ã€‚ã‚«ãƒ¡ãŒè‹¦ã—ã‚“ã§ã„ã¾ã™ã€‚"
            },
            "Leave quietly": {
                translation: "é™ã‹ã«ç«‹ã¡å»ã‚‹",
                explanation: "å¤ªéƒã¯å‹•ç‰©ã‚’å¤§åˆ‡ã«ã—ã¾ã™ã€‚å›°ã£ã¦ã„ã‚‹ç”Ÿãç‰©ã‚’æ”¾ã£ã¦ãŠã‘ã¾ã›ã‚“ã€‚"
            },
            
            // Add more choice translations as needed for key scenes
            "Accept the invitation": {
                translation: "æ‹›å¾…ã‚’å—ã‘å…¥ã‚Œã‚‹",
                explanation: "æ­£è§£ï¼æ–°ã—ã„å†’é™ºã‚’å—ã‘å…¥ã‚Œã‚‹å‹‡æ°—ãŒå¤ªéƒã®é­…åŠ›ã§ã™ã€‚"
            },
            "Ask to return home": {
                translation: "å®¶ã«å¸°ã‚ŠãŸã„ã¨é ¼ã‚€",
                explanation: "æ­£è§£ï¼å®¶æ—ã‚„æ•…éƒ·ã‚’æ€ã†æ°—æŒã¡ã¯è‡ªç„¶ã§ç¾ã—ã„ã‚‚ã®ã§ã™ã€‚"
            },
            "Promise never to open it": {
                translation: "çµ¶å¯¾ã«é–‹ã‘ãªã„ã¨ç´„æŸã™ã‚‹",
                explanation: "æ­£è§£ï¼ç´„æŸã‚’å®ˆã‚‹ã“ã¨ãŒå¤ªéƒã®ç¾å¾³ã§ã™ã€‚ä¹™å§«æ§˜ã¨ã®ç´„æŸã¯å¤§åˆ‡ã«ã—ã¾ã—ã‚‡ã†ã€‚"
            },
            "Keep your promise and never open the box": {
                translation: "ç´„æŸã‚’å®ˆã‚Šç®±ã‚’é–‹ã‘ãªã„",
                explanation: "æ­£è§£ï¼ç´„æŸã‚’å®ˆã‚‹ã“ã¨ãŒæœ€ã‚‚å¤§åˆ‡ã§ã™ã€‚èª å®Ÿã•ãŒå¤ªéƒã®ç¾å¾³ã§ã™ã€‚"
            }
        };

        // Scene audio content (extended with all new scenes)
        const sceneAudioContent = {
            'scene1': "Long, long ago, in a small fishing village by the sea, there lived a young man named Urashima Taro. Taro was known throughout the village for his kindness and gentle heart. Every morning, he would wake up early and prepare his fishing boat and nets.",
            'scene2': "Taro walked to the beautiful sandy beach where his boat was waiting. The morning sun sparkled on the calm blue water. Seabirds flew overhead, calling to each other. As he prepared his fishing nets, he heard some noise coming from the rocks near the shore.",
            'scene3': "Taro walked toward the rocks and discovered a group of children. They had found a large sea turtle and were poking it with sticks, laughing loudly. The poor turtle was trying to return to the water, but the children kept blocking its path.",
            'scene4': "Children, please don't hurt this turtle, Taro said kindly. It's a living creature, just like us. The children looked up at Taro. He knelt down to their level and spoke gently. How would you feel if someone much bigger than you treated you this way?",
            'scene5': "The children looked at each other, then at the turtle. They began to understand. We're sorry, Mr. Taro, said the youngest child. We didn't mean to hurt it. The children stepped back and watched as the turtle slowly moved toward the water.",
            'scene6': "Taro gently picked up the large turtle. It was heavier than he expected. He carried it carefully to the water's edge and placed it gently in the shallow waves. The turtle looked up at Taro with its wise, old eyes before swimming away.",
            'scene7': "As Taro watched, something amazing happened. The turtle turned around and swam back to him. It lifted its head above the water and, to Taro's amazement, began to speak! Thank you, kind young man, for saving my life, said the turtle in a gentle voice.",
            'scene8': "I am actually a servant of the Dragon King who rules the sea, explained the turtle. My master would like to meet you and thank you personally for your kindness. Would you come with me to the Dragon Palace under the sea?",
            'scene9': "I would be honored to meet the Dragon King, Taro replied with a bow. The turtle swam closer to the shore. Please climb on my back, it said. Taro carefully stepped onto the turtle's large, strong shell.",
            'scene10': "The turtle began to dive deeper and deeper into the blue ocean. To Taro's amazement, he found he could breathe perfectly underwater! Beautiful fish of every color swam around them, and coral gardens sparkled in the deep.",
            'scene11': "Soon they arrived at the most magnificent palace Taro had ever imagined. It was made of coral and pearls, with towers that spiraled toward the surface. Fish of gold and silver swam in and out of the palace windows like living decorations.",
            'scene12': "Inside the palace, Taro met the Dragon King and his beautiful daughter, Princess Otohime. Welcome, kind Urashima Taro, said the Dragon King. You have shown great compassion today. Please, stay with us and enjoy the wonders of our undersea kingdom.",
            'scene13': "Taro spent his first day in the Dragon Palace amazed by its wonders. Princess Otohime showed him gardens of sea anemones and singing whales. The food was more delicious than anything he had ever tasted.",
            'scene14': "As days passed, Taro and Princess Otohime became close friends. She taught him about the sea creatures and the mysteries of the ocean. Taro shared stories of his village and the life of fishermen.",
            'scene15': "One day, as Taro watched the sunset through the water, he felt a pang in his heart. He realized he missed his village, his family, and his simple fishing boat. Though the palace was beautiful, he longed for his home.",
            'scene16': "I understand, dear Taro, said Princess Otohime sadly but kindly. Home is always in one's heart. Though I will miss you, you must follow your heart. I have a gift for you before you leave, she said, producing a beautiful lacquered box.",
            'scene17': "This is called Tamatebako, the Princess explained. But you must promise me one thing - never, ever open this box. If you open it, something terrible will happen, and you can never return here.",
            'scene18': "The same kind turtle carried Taro back to the surface. As they rose through the blue water, Taro clutched the mysterious box carefully. Soon, he could see the sunlight sparkling on the waves above.",
            'scene19': "Taro stepped onto the familiar beach, but something was wrong. The village looked completely different! The houses were different, the people were strangers. An old man approached him. Young man, this village hasn't had anyone named Urashima Taro for over 300 years!",
            'scene20': "The old man explained, Urashima Taro was a legend from long ago. They say he saved a turtle and disappeared into the sea. Taro realized that time moved differently in the Dragon Palace. What felt like days underwater had been centuries on land!",
            'scene21': "Taro sat alone on the beach, feeling lost and lonely. Everyone he had ever known was gone. His old life had disappeared. In his hands, he still held the mysterious Tamatebako box from Princess Otohime."
        };

        // Choice audio content (extended)
        const choiceAudioContent = {
            'Go fishing to help feed the village': 'Go fishing to help feed the village',
            'Stay home and rest': 'Stay home and rest',
            'Go to the market instead': 'Go to the market instead',
            'Investigate the noise': 'Investigate the noise',
            'Ignore it and go fishing': 'Ignore it and go fishing',
            'Call for help immediately': 'Call for help immediately',
            'Gently ask the children to stop': 'Gently ask the children to stop',
            'Shout angrily at the children': 'Shout angrily at the children',
            'Join the children': 'Join the children',
            'Wait patiently for their response': 'Wait patiently for their response',
            'Take the turtle away immediately': 'Take the turtle away immediately',
            'Threaten to tell their parents': 'Threaten to tell their parents',
            'Help the turtle reach the water safely': 'Help the turtle reach the water safely',
            'Leave immediately': 'Leave immediately',
            'Lecture the children more': 'Lecture the children more',
            'Watch the turtle swim away peacefully': 'Watch the turtle swim away peacefully',
            'Go fishing immediately': 'Go fishing immediately',
            'Ask for a reward': 'Ask for a reward',
            'Listen politely to what the turtle has to say': 'Listen politely to what the turtle has to say',
            'Run away in fear': 'Run away in fear',
            'Think it is a dream and ignore it': 'Think it is a dream and ignore it',
            'Accept the invitation with gratitude': 'Accept the invitation with gratitude',
            'Politely decline': 'Politely decline',
            'Ask what is in it for him': 'Ask what is in it for him',
            'Hold on carefully and trust the turtle': 'Hold on carefully and trust the turtle',
            'Jump off immediately': 'Jump off immediately',
            'Ask to go back': 'Ask to go back',
            'Marvel at the underwater beauty': 'Marvel at the underwater beauty',
            'Panic about breathing underwater': 'Panic about breathing underwater',
            'Try to swim away': 'Try to swim away',
            'Express wonder and gratitude': 'Express wonder and gratitude',
            'Ask about the value of the palace': 'Ask about the value of the palace',
            'Remain silent and unimpressed': 'Remain silent and unimpressed',
            'Bow respectfully and thank them': 'Bow respectfully and thank them',
            'Immediately ask for treasures': 'Immediately ask for treasures',
            'Say you want to go home right away': 'Say you want to go home right away',
            'Enjoy the experience with gratitude': 'Enjoy the experience with gratitude',
            'Complain that it is different from home': 'Complain that it is different from home',
            'Ask when you can leave': 'Ask when you can leave',
            'Share stories and learn about each others worlds': 'Share stories and learn about each others worlds',
            'Only talk about yourself': 'Only talk about yourself',
            'Remain distant and formal': 'Remain distant and formal',
            'Honestly share your feelings with the Princess': 'Honestly share your feelings with the Princess',
            'Hide your feelings and pretend to be happy': 'Hide your feelings and pretend to be happy',
            'Demand to leave immediately': 'Demand to leave immediately',
            'Accept the gift with gratitude': 'Accept the gift with gratitude',
            'Refuse the gift': 'Refuse the gift',
            'Ask what is inside': 'Ask what is inside',
            'Promise solemnly never to open it': 'Promise solemnly never to open it',
            'Ask why you cannot open it': 'Ask why you cannot open it',
            'Say you cannot make such a promise': 'Say you cannot make such a promise',
            'Thank the turtle for everything': 'Thank the turtle for everything',
            'Ask to go back to the palace': 'Ask to go back to the palace',
            'Look inside the box': 'Look inside the box',
            'Ask more questions about what happened': 'Ask more questions about what happened',
            'Refuse to believe it': 'Refuse to believe it',
            'Run away in panic': 'Run away in panic',
            'Accept this sad reality': 'Accept this sad reality',
            'Deny everything': 'Deny everything',
            'Blame the turtle': 'Blame the turtle',
            'Keep your promise and never open the box': 'Keep your promise and never open the box',
            'Open the box in desperation': 'Open the box in desperation',
            'Throw the box into the sea': 'Throw the box into the sea',
            'Play Again': 'Play Again',
            'Try Again': 'Try Again',
            'Start Over': 'Start Over',
            'Return to rules explanation': 'Return to rules explanation'
        };

        function playSceneAudio(sceneId) {
            // Stop any current speech
            stopAudio();
            
            const storyTextDiv = document.querySelector(`[data-scene="${sceneId}"]`);
            if (!storyTextDiv) return;
            
            const paragraphs = storyTextDiv.querySelectorAll('p');
            let textToSpeak = '';
            
            // Combine all paragraph text, removing emojis and special characters for better speech
            paragraphs.forEach(p => {
                let text = p.textContent || p.innerText;
                // Clean text for speech (remove emojis, special symbols)
                text = text.replace(/[ğŸ‘ğŸ‰ğŸ†ğŸš«ğŸ”Šâ¹ï¸ğŸ˜¢]/g, '');
                text = text.replace(/[^\w\s.,!?-]/g, '');
                textToSpeak += text + ' ';
            });
            
            if (textToSpeak.trim() === '') return;
            
            // Check if speech synthesis is supported
            if ('speechSynthesis' in window) {
                currentSpeech = new SpeechSynthesisUtterance(textToSpeak);
                
                // Configure speech settings
                currentSpeech.lang = 'en-US';
                currentSpeech.rate = 0.6; // Slower for learning
                currentSpeech.pitch = 1.0;
                currentSpeech.volume = 1.0;
                
                // Start speech
                speechSynthesis.speak(currentSpeech);
            } else {
                alert('ãŠä½¿ã„ã®ãƒ–ãƒ©ã‚¦ã‚¶ã¯éŸ³å£°æ©Ÿèƒ½ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ã¾ã›ã‚“ã€‚');
            }
        }

        function playChoiceAudio(choiceText) {
            stopAudio();
            
            if (choiceAudioContent[choiceText]) {
                const utterance = new SpeechSynthesisUtterance(choiceAudioContent[choiceText]);
                utterance.lang = 'en-US';
                utterance.rate = 0.8;
                utterance.pitch = 1;
                utterance.volume = 0.8;
                
                currentAudio = utterance;
                speechSynthesis.speak(utterance);
            }
        }

        function stopAudio() {
            if (currentSpeech) {
                speechSynthesis.cancel();
                currentSpeech = null;
            }
        }

        function goToScene(sceneId) {
            // Hide all scenes first
            const allScenes = document.querySelectorAll('.scene');
            allScenes.forEach(scene => scene.classList.add('hidden'));
            
            // Show new scene
            previousScene = currentScene;
            currentScene = sceneId;
            
            // Update scene number
            if (sceneId.startsWith('scene')) {
                currentSceneNumber = parseInt(sceneId.replace('scene', ''));
                updateProgress();
            }
            
            // Show new scene
            const newSceneElement = document.getElementById(sceneId);
            if (newSceneElement) {
                newSceneElement.classList.remove('hidden');
                
                // Shuffle choices for the new scene
                initializeSceneChoices(sceneId);
                
                // Smooth scroll to top
                window.scrollTo({ top: 0, behavior: 'smooth' });
                
                // Add fade-in animation
                newSceneElement.classList.add('fade-in');
                setTimeout(() => {
                    newSceneElement.classList.remove('fade-in');
                }, 800);
            } else {
                console.error('Scene element not found: ' + sceneId);
            }
        }

        function updateProgress() {
            const progressPercentage = (currentSceneNumber / totalScenes) * 100;
            document.getElementById('progress-fill').style.width = progressPercentage + '%';
            document.getElementById('scene-progress').textContent = `Scene ${currentSceneNumber} of ${totalScenes}`;
        }

        function displayChoiceExplanation(sceneId) {
            // This function will look for explanation elements in any scene
            // If they don't exist, it will skip silently
            const explanationDiv = document.getElementById(sceneId + '-explanation');
            const dividerDiv = document.getElementById(sceneId + '-divider');
            const choiceTextSpan = document.getElementById(sceneId + '-choice-text');
            const translationDiv = document.getElementById(sceneId + '-choice-translation');
            const explanationTextDiv = document.getElementById(sceneId + '-choice-explanation');
            
            // Previous question elements
            const previousQuestionDiv = document.getElementById(sceneId + '-previous-question');
            const previousQuestionTranslationDiv = document.getElementById(sceneId + '-previous-question-translation');
            
            // Only proceed if the basic elements exist
            if (explanationDiv && choiceTextSpan && translationDiv && explanationTextDiv) {
                // Populate the choice content safely using textContent
                choiceTextSpan.textContent = selectedChoiceInfo.text;
                translationDiv.textContent = selectedChoiceInfo.translation;
                explanationTextDiv.textContent = selectedChoiceInfo.explanation;
                
                // Populate previous question if elements exist
                if (previousQuestionDiv && previousQuestionTranslationDiv && previousQuestionInfo.text) {
                    previousQuestionDiv.textContent = previousQuestionInfo.text;
                    previousQuestionTranslationDiv.textContent = previousQuestionInfo.translation;
                }
                
                // Show the explanation elements
                explanationDiv.classList.remove('hidden');
                if (dividerDiv) {
                    dividerDiv.classList.remove('hidden');
                }
            }
        }
        
        function selectChoiceAndGoToScene(nextSceneId, selectedChoice) {
            // Extract previous question from current scene
            const currentSceneElement = document.getElementById(currentScene);
            if (currentSceneElement) {
                const storyTextElement = currentSceneElement.querySelector('.story-text');
                if (storyTextElement) {
                    const paragraphs = storyTextElement.querySelectorAll('p');
                    if (paragraphs.length > 0) {
                        const lastParagraph = paragraphs[paragraphs.length - 1];
                        const questionText = lastParagraph.textContent.trim();
                        
                        // Store previous question info
                        previousQuestionInfo = {
                            text: questionText,
                            translation: questionTranslations[questionText] || 'ã“ã®å•é¡Œã®ç¿»è¨³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“'
                        };
                    }
                }
            }
            
            // Look up translation and explanation from the dictionary
            const choiceData = choiceTranslations[selectedChoice];
            
            if (choiceData) {
                // Store the selected choice information
                selectedChoiceInfo = {
                    text: selectedChoice,
                    translation: choiceData.translation,
                    explanation: choiceData.explanation
                };
            } else {
                // Fallback if translation not found
                selectedChoiceInfo = {
                    text: selectedChoice,
                    translation: 'ç¿»è¨³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
                    explanation: 'ã“ã®é¸æŠè‚¢ã®èª¬æ˜ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚'
                };
            }
            
            goToScene(nextSceneId);
            
            // Display the explanation if elements exist
            displayChoiceExplanation(nextSceneId);
        }

        function showWrongChoice(fromScene, selectedChoice = '') {
            previousScene = fromScene;
            
            // Look up translation and explanation from the dictionary
            const choiceData = choiceTranslations[selectedChoice];
            
            if (choiceData) {
                // Store the selected choice information
                selectedChoiceInfo = {
                    text: selectedChoice,
                    translation: choiceData.translation,
                    explanation: choiceData.explanation
                };
            } else {
                // Fallback if translation not found
                selectedChoiceInfo = {
                    text: selectedChoice,
                    translation: 'ç¿»è¨³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“',
                    explanation: 'ã“ã®é¸æŠè‚¢ã®èª¬æ˜ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚'
                };
            }
            
            goToScene('wrong-message');
            
            // Display the explanation
            displayChoiceExplanation('wrong-message');
        }

        function goBack() {
            // Simple direct approach
            currentSceneNumber = parseInt(previousScene.replace('scene', ''));
            goToScene(previousScene);
        }

        function restartGame() {
            // Hide all scenes
            const scenes = document.querySelectorAll('.scene');
            scenes.forEach(scene => {
                scene.classList.add('hidden');
                // Hide any visible explanations
                const explanation = scene.querySelector('.choice-explanation');
                const divider = scene.querySelector('.section-divider');
                if (explanation) explanation.classList.add('hidden');
                if (divider) divider.classList.add('hidden');
            });
            
            // Reset game state
            currentScene = 'scene1';
            previousScene = 'scene1';
            currentSceneNumber = 1;
            selectedChoiceInfo = { text: '', translation: '', explanation: '' };
            
            // Show first scene and update progress
            document.getElementById('scene1').classList.remove('hidden');
            updateProgress();
            
            // Shuffle choices for the first scene
            initializeSceneChoices('scene1');
            
            // Stop audio and scroll to top
            stopAudio();
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }

        // Choice shuffling functions
        function shuffleArray(array) {
            for (let i = array.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [array[i], array[j]] = [array[j], array[i]];
            }
            return array;
        }

        function shuffleChoices(sceneId) {
            const scene = document.getElementById(sceneId);
            if (!scene) return;
            
            const choicesContainer = scene.querySelector('.choices');
            if (!choicesContainer) return;
            
            const choiceContainers = Array.from(choicesContainer.querySelectorAll('.choice-container'));
            if (choiceContainers.length > 1) {
                shuffleArray(choiceContainers);
                choiceContainers.forEach(container => {
                    choicesContainer.appendChild(container);
                });
            }
        }

        function initializeSceneChoices(sceneId) {
            // Shuffle choices when scene is displayed
            shuffleChoices(sceneId);
        }

        // Initialize
        updateProgress();
        initializeSceneChoices('scene1');
    </script>
</body>
</html>